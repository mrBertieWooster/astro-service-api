from sqlalchemy.orm import Session
from sqlalchemy.future import select
from app.api.v1.models.tarot import TarotCard
from app.db.database import async_session
import asyncio
import logging

logger = logging.getLogger(__name__)

tarot_cards = [
    # Major Arcana
    {"name": "Шут", "arcana": "major", "description": "Новый путь, спонтанность, авантюра.",
     "upright_meaning": "Свобода, открытость к возможностям, новые начинания.",
     "reversed_meaning": "Безрассудство, риск, наивность, неопытность."},

    {"name": "Маг", "arcana": "major", "description": "Сила воли, мастерство, возможности.",
     "upright_meaning": "Контроль над своей судьбой, креативность, ресурсность.",
     "reversed_meaning": "Манипуляции, обман, неиспользованный потенциал."},

    {"name": "Жрица", "arcana": "major", "description": "Интуиция, тайные знания, внутренняя мудрость.",
     "upright_meaning": "Проницательность, глубокие познания, духовность.",
     "reversed_meaning": "Тайны, иллюзии, отказ от слушания интуиции."},

    {"name": "Императрица", "arcana": "major", "description": "Материнство, природа, изобилие.",
     "upright_meaning": "Творчество, плодородие, забота, гармония.",
     "reversed_meaning": "Застой, чрезмерная опека, нехватка вдохновения."},

    {"name": "Император", "arcana": "major", "description": "Структура, порядок, власть.",
     "upright_meaning": "Стабильность, дисциплина, контроль, лидерство.",
     "reversed_meaning": "Тирания, деспотизм, жесткость, контроль."},

    {"name": "Иерофант", "arcana": "major", "description": "Традиции, духовность, обучение.",
     "upright_meaning": "Совет, наставничество, поиск смысла.",
     "reversed_meaning": "Догматизм, бунт, отказ от традиций."},

    {"name": "Влюбленные", "arcana": "major", "description": "Любовь, выбор, гармония.",
     "upright_meaning": "Сильная связь, партнёрство, честность.",
     "reversed_meaning": "Конфликты, разрыв, нерешительность."},

    {"name": "Колесница", "arcana": "major", "description": "Победа, движение, уверенность.",
     "upright_meaning": "Достижение целей, решимость, контроль.",
     "reversed_meaning": "Отсутствие контроля, медлительность, сомнения."},

    {"name": "Сила", "arcana": "major", "description": "Мужество, внутренняя сила, терпение.",
     "upright_meaning": "Выносливость, сострадание, самоконтроль.",
     "reversed_meaning": "Слабость, неуверенность, страхи."},

    {"name": "Отшельник", "arcana": "major", "description": "Одиночество, самопознание, поиск истины.",
     "upright_meaning": "Размышление, осознание, внутренняя мудрость.",
     "reversed_meaning": "Изоляция, отстраненность, потерянность."},

    {"name": "Колесо Фортуны", "arcana": "major", "description": "Судьба, перемены, удача.",
     "upright_meaning": "Удачные возможности, циклы жизни.",
     "reversed_meaning": "Непредсказуемость, застой, неудача."},

    {"name": "Справедливость", "arcana": "major", "description": "Истина, закон, карма.",
     "upright_meaning": "Честность, справедливое возмездие.",
     "reversed_meaning": "Обман, несправедливость, субъективность."},

    {"name": "Повешенный", "arcana": "major", "description": "Жертва, изменение перспективы, пауза.",
     "upright_meaning": "Отказ от старого, осознание, терпение.",
     "reversed_meaning": "Сопротивление переменам, страх отпустить."},

    {"name": "Смерть", "arcana": "major", "description": "Трансформация, конец, начало нового.",
     "upright_meaning": "Закрытие цикла, внутренний рост, перемены.",
     "reversed_meaning": "Страх перемен, застой, сопротивление."},

    {"name": "Умеренность", "arcana": "major", "description": "Гармония, баланс, терпение.",
     "upright_meaning": "Спокойствие, сотрудничество, умеренность.",
     "reversed_meaning": "Крайности, нехватка контроля, дисбаланс."},

    {"name": "Дьявол", "arcana": "major", "description": "Зависимости, искушения, привязанность.",
     "upright_meaning": "Материальные привязанности, соблазны.",
     "reversed_meaning": "Освобождение, осознание, контроль над собой."},

    {"name": "Башня", "arcana": "major", "description": "Разрушение, шок, внезапные перемены.",
     "upright_meaning": "Кризис, катастрофа, шокирующее открытие.",
     "reversed_meaning": "Предупреждение, сопротивление переменам."},

    {"name": "Звезда", "arcana": "major", "description": "Надежда, вдохновение, духовность.",
     "upright_meaning": "Оптимизм, восстановление, творчество.",
     "reversed_meaning": "Пессимизм, отчаяние, утрата веры."},

    {"name": "Луна", "arcana": "major", "description": "Иллюзии, страхи, скрытое.",
     "upright_meaning": "Интуиция, тайны, эмоции.",
     "reversed_meaning": "Ясность, правда, устранение заблуждений."},

    {"name": "Солнце", "arcana": "major", "description": "Радость, успех, процветание.",
     "upright_meaning": "Счастье, уверенность, удача.",
     "reversed_meaning": "Излишний эгоизм, временные трудности."},

    {"name": "Суд", "arcana": "major", "description": "Возрождение, осознание, кармическое воздаяние.",
     "upright_meaning": "Перемены, трансформация, новое начало.",
     "reversed_meaning": "Ограничения, сомнения, страх перемен."},

    {"name": "Мир", "arcana": "major", "description": "Завершение, целостность, успех.",
     "upright_meaning": "Исполнение желаемого, гармония.",
     "reversed_meaning": "Незавершенность, внутренние блоки."}
]

tarot_cards_wands = [
    {"name": "Туз Жезлов", "arcana": "minor", "suit": "wands",
     "description": "Новый импульс, идеи, творческий потенциал.",
     "upright_meaning": "Начало нового проекта, вдохновение, энтузиазм.",
     "reversed_meaning": "Откладывание начинаний, нехватка мотивации."},

    {"name": "Двойка Жезлов", "arcana": "minor", "suit": "wands",
     "description": "Выбор пути, дальновидность, планы.",
     "upright_meaning": "Размышление о будущем, баланс между комфортом и риском.",
     "reversed_meaning": "Страх перед переменами, неопределенность, колебания."},

    {"name": "Тройка Жезлов", "arcana": "minor", "suit": "wands",
     "description": "Расширение горизонтов, уверенность, стратегическое мышление.",
     "upright_meaning": "Перспективы, начало большого дела, уверенность в будущем.",
     "reversed_meaning": "Отсутствие дальновидности, упущенные возможности."},

    {"name": "Четверка Жезлов", "arcana": "minor", "suit": "wands",
     "description": "Стабильность, радость, праздник.",
     "upright_meaning": "Гармония в семье, успех, достижение.",
     "reversed_meaning": "Разлад, семейные конфликты, чувство одиночества."},

    {"name": "Пятерка Жезлов", "arcana": "minor", "suit": "wands",
     "description": "Соперничество, борьба, хаос.",
     "upright_meaning": "Дискуссии, столкновение интересов, конкуренция.",
     "reversed_meaning": "Избегание конфликтов, компромиссы, пассивность."},

    {"name": "Шестерка Жезлов", "arcana": "minor", "suit": "wands",
     "description": "Победа, признание, успех.",
     "upright_meaning": "Достижение целей, лидерство, уважение.",
     "reversed_meaning": "Эгоизм, потеря уверенности, тщеславие."},

    {"name": "Семерка Жезлов", "arcana": "minor", "suit": "wands",
     "description": "Защита позиций, стойкость, испытания.",
     "upright_meaning": "Защита своих интересов, борьба за идеалы.",
     "reversed_meaning": "Сдача позиций, недостаток уверенности."},

    {"name": "Восьмерка Жезлов", "arcana": "minor", "suit": "wands",
     "description": "Быстрое развитие событий, новости, движение.",
     "upright_meaning": "Быстрые перемены, прогресс, неожиданности.",
     "reversed_meaning": "Задержки, препятствия, неожиданные трудности."},

    {"name": "Девятка Жезлов", "arcana": "minor", "suit": "wands",
     "description": "Выносливость, защита, опыт.",
     "upright_meaning": "Осторожность, готовность к борьбе.",
     "reversed_meaning": "Паранойя, страх, неспособность доверять."},

    {"name": "Десятка Жезлов", "arcana": "minor", "suit": "wands",
     "description": "Бремя, ответственность, перегрузка.",
     "upright_meaning": "Чрезмерная нагрузка, обязанность, стресс.",
     "reversed_meaning": "Освобождение от тяжести, отказ от груза."},

    {"name": "Паж Жезлов", "arcana": "minor", "suit": "wands",
     "description": "Любопытство, энтузиазм, новые идеи.",
     "upright_meaning": "Исследование новых возможностей, вдохновение.",
     "reversed_meaning": "Инфантильность, неуверенность, боязнь действий."},

    {"name": "Рыцарь Жезлов", "arcana": "minor", "suit": "wands",
     "description": "Приключения, страсть, порыв.",
     "upright_meaning": "Быстрые перемены, смелые поступки, решительность.",
     "reversed_meaning": "Импульсивность, непоследовательность, агрессия."},

    {"name": "Королева Жезлов", "arcana": "minor", "suit": "wands",
     "description": "Харизма, уверенность, лидерство.",
     "upright_meaning": "Амбиции, энергия, творческий потенциал.",
     "reversed_meaning": "Высокомерие, манипуляции, неуверенность."},

    {"name": "Король Жезлов", "arcana": "minor", "suit": "wands",
     "description": "Целеустремленность, сила воли, вдохновение.",
     "upright_meaning": "Лидерство, влияние, смелость.",
     "reversed_meaning": "Деспотизм, жесткость, упрямство."}
]


tarot_cards_cups = [
    {"name": "Туз Кубков", "arcana": "minor", "suit": "cups",
     "description": "Новые эмоции, вдохновение, начало любви.",
     "upright_meaning": "Открытость чувствам, новые отношения, эмоциональное пробуждение.",
     "reversed_meaning": "Подавленные эмоции, эмоциональная блокировка, разочарование."},

    {"name": "Двойка Кубков", "arcana": "minor", "suit": "cups",
     "description": "Гармония, партнерство, эмоциональная связь.",
     "upright_meaning": "Любовь, крепкие отношения, душевная близость.",
     "reversed_meaning": "Дисгармония, конфликты в отношениях, разлад."},

    {"name": "Тройка Кубков", "arcana": "minor", "suit": "cups",
     "description": "Радость, дружба, празднование.",
     "upright_meaning": "Воссоединение, счастье, поддержка друзей.",
     "reversed_meaning": "Сплетни, эмоциональное истощение, поверхностные связи."},

    {"name": "Четверка Кубков", "arcana": "minor", "suit": "cups",
     "description": "Равнодушие, разочарование, скука.",
     "upright_meaning": "Недовольство текущей ситуацией, отказ видеть возможности.",
     "reversed_meaning": "Осознание ценности жизни, преодоление апатии."},

    {"name": "Пятерка Кубков", "arcana": "minor", "suit": "cups",
     "description": "Горе, потери, сожаление.",
     "upright_meaning": "Фокус на потерях, эмоциональная боль, разочарование.",
     "reversed_meaning": "Принятие, поиск новых возможностей, движение вперед."},

    {"name": "Шестерка Кубков", "arcana": "minor", "suit": "cups",
     "description": "Ностальгия, воспоминания, детство.",
     "upright_meaning": "Теплые воспоминания, приятные моменты прошлого, восстановление связей.",
     "reversed_meaning": "Жизнь в прошлом, трудности с отпусканием прошлого."},

    {"name": "Семерка Кубков", "arcana": "minor", "suit": "cups",
     "description": "Иллюзии, мечты, выбор.",
     "upright_meaning": "Фантазии, множество возможностей, соблазны.",
     "reversed_meaning": "Реалистичный подход, осознание реального положения вещей."},

    {"name": "Восьмерка Кубков", "arcana": "minor", "suit": "cups",
     "description": "Отказ, уход, духовный поиск.",
     "upright_meaning": "Оставление прошлого, поиск смысла, эмоциональный рост.",
     "reversed_meaning": "Страх перемен, эмоциональная зависимость, бегство от реальности."},

    {"name": "Девятка Кубков", "arcana": "minor", "suit": "cups",
     "description": "Исполнение желаний, удовлетворение, радость.",
     "upright_meaning": "Счастье, удача, реализация мечты.",
     "reversed_meaning": "Эмоциональная пустота, завышенные ожидания, эгоизм."},

    {"name": "Десятка Кубков", "arcana": "minor", "suit": "cups",
     "description": "Семейное счастье, гармония, радость.",
     "upright_meaning": "Любовь, крепкие отношения, душевное равновесие.",
     "reversed_meaning": "Конфликты в семье, разлад, эмоциональная неудовлетворенность."},

    {"name": "Паж Кубков", "arcana": "minor", "suit": "cups",
     "description": "Чувствительность, романтичность, воображение.",
     "upright_meaning": "Творческое вдохновение, новости о любви, эмоциональная открытость.",
     "reversed_meaning": "Инфантильность, разочарование в любви, эмоциональная неустойчивость."},

    {"name": "Рыцарь Кубков", "arcana": "minor", "suit": "cups",
     "description": "Очарование, романтика, мечтательность.",
     "upright_meaning": "Признание в любви, новые эмоции, творческий процесс.",
     "reversed_meaning": "Иллюзии в отношениях, неискренность, непостоянство."},

    {"name": "Королева Кубков", "arcana": "minor", "suit": "cups",
     "description": "Интуиция, сочувствие, забота.",
     "upright_meaning": "Глубокая эмоциональная связь, женская мудрость, чуткость.",
     "reversed_meaning": "Эмоциональная нестабильность, манипуляции, зависимость."},

    {"name": "Король Кубков", "arcana": "minor", "suit": "cups",
     "description": "Эмоциональный баланс, дипломатия, поддержка.",
     "upright_meaning": "Контроль над эмоциями, доброжелательность, заботливый партнер.",
     "reversed_meaning": "Подавленные эмоции, манипуляции, зависимость."}
]

tarot_cards_swords = [
    {"name": "Туз Мечей", "arcana": "minor", "suit": "swords",
     "description": "Прозрение, новые идеи, истина.",
     "upright_meaning": "Ясность, интеллект, принятие решений, успех через правду.",
     "reversed_meaning": "Заблуждение, путаница, ложь, неудачное начинание."},

    {"name": "Двойка Мечей", "arcana": "minor", "suit": "swords",
     "description": "Дилемма, неуверенность, баланс.",
     "upright_meaning": "Необходимость принятия решения, поиск компромисса, временное равновесие.",
     "reversed_meaning": "Избегание проблем, тупик, страх выбора."},

    {"name": "Тройка Мечей", "arcana": "minor", "suit": "swords",
     "description": "Боль, предательство, разрыв.",
     "upright_meaning": "Разбитое сердце, глубокие эмоциональные раны, горе.",
     "reversed_meaning": "Заживление ран, прощение, восстановление после боли."},

    {"name": "Четверка Мечей", "arcana": "minor", "suit": "swords",
     "description": "Отдых, восстановление, пауза.",
     "upright_meaning": "Необходимость передышки, медитация, восстановление сил.",
     "reversed_meaning": "Беспокойство, стресс, невозможность расслабиться."},

    {"name": "Пятерка Мечей", "arcana": "minor", "suit": "swords",
     "description": "Конфликт, победа любой ценой.",
     "upright_meaning": "Манипуляции, эгоизм, нечестная игра, потери.",
     "reversed_meaning": "Примирение, осознание последствий своих действий, освобождение от вражды."},

    {"name": "Шестерка Мечей", "arcana": "minor", "suit": "swords",
     "description": "Перемены, путь к лучшему, уход.",
     "upright_meaning": "Избавление от трудностей, поиск спокойствия, духовный рост.",
     "reversed_meaning": "Трудности на пути, страх перед будущим, невозможность двигаться вперед."},

    {"name": "Семерка Мечей", "arcana": "minor", "suit": "swords",
     "description": "Обман, хитрость, скрытые намерения.",
     "upright_meaning": "Манипуляции, утаивание правды, коварство, предательство.",
     "reversed_meaning": "Раскрытие обмана, честность, исправление ошибок."},

    {"name": "Восьмерка Мечей", "arcana": "minor", "suit": "swords",
     "description": "Ограничения, страх, тревога.",
     "upright_meaning": "Чувство беспомощности, ограничения, самосаботаж.",
     "reversed_meaning": "Освобождение от страхов, поиск выхода, обретение контроля."},

    {"name": "Девятка Мечей", "arcana": "minor", "suit": "swords",
     "description": "Беспокойство, страхи, ночные кошмары.",
     "upright_meaning": "Мучительные переживания, стресс, бессонные ночи.",
     "reversed_meaning": "Облегчение, преодоление страха, выход из кризиса."},

    {"name": "Десятка Мечей", "arcana": "minor", "suit": "swords",
     "description": "Завершение, конец, разрушение.",
     "upright_meaning": "Предательство, боль, окончание трудного этапа.",
     "reversed_meaning": "Восстановление, надежда, новый путь после трудностей."},

    {"name": "Паж Мечей", "arcana": "minor", "suit": "swords",
     "description": "Любознательность, наблюдательность, интеллект.",
     "upright_meaning": "Поиск знаний, анализ, честность, прямолинейность.",
     "reversed_meaning": "Сплетни, ложь, чрезмерное любопытство, подозрительность."},

    {"name": "Рыцарь Мечей", "arcana": "minor", "suit": "swords",
     "description": "Движение вперед, решительность, агрессия.",
     "upright_meaning": "Смелые действия, стремление к успеху, логика и аналитика.",
     "reversed_meaning": "Безрассудство, поспешные решения, конфликтность."},

    {"name": "Королева Мечей", "arcana": "minor", "suit": "swords",
     "description": "Независимость, проницательность, интеллект.",
     "upright_meaning": "Четкость ума, логика, эмоциональная сдержанность, мудрость.",
     "reversed_meaning": "Жестокость, отстраненность, холодность, сарказм."},

    {"name": "Король Мечей", "arcana": "minor", "suit": "swords",
     "description": "Лидерство, логика, интеллект.",
     "upright_meaning": "Разум, объективность, власть, стратегическое мышление.",
     "reversed_meaning": "Тиран, манипуляции, коррумпированная власть, отсутствие логики."}
]

tarot_cards_pentacles = [
    {"name": "Туз Пентаклей", "arcana": "minor", "suit": "pentacles",
     "description": "Шанс, возможности, материальный успех.",
     "upright_meaning": "Новые финансовые возможности, стабильность, изобилие.",
     "reversed_meaning": "Потерянные возможности, неудачные вложения, нестабильность."},

    {"name": "Двойка Пентаклей", "arcana": "minor", "suit": "pentacles",
     "description": "Баланс, гибкость, управление ресурсами.",
     "upright_meaning": "Необходимость сохранять баланс, умение адаптироваться, финансовая нестабильность.",
     "reversed_meaning": "Дисбаланс, перегрузка, ошибки в управлении ресурсами."},

    {"name": "Тройка Пентаклей", "arcana": "minor", "suit": "pentacles",
     "description": "Работа в команде, мастерство, рост.",
     "upright_meaning": "Совместная работа, успех благодаря усилиям, развитие навыков.",
     "reversed_meaning": "Разногласия в команде, недостаток опыта, плохая организация."},

    {"name": "Четверка Пентаклей", "arcana": "minor", "suit": "pentacles",
     "description": "Жадность, накопление, страх потерь.",
     "upright_meaning": "Сохранение ресурсов, осторожность, стабильность.",
     "reversed_meaning": "Скупость, боязнь потерять, материализм, излишняя осторожность."},

    {"name": "Пятерка Пентаклей", "arcana": "minor", "suit": "pentacles",
     "description": "Трудности, финансовый кризис, изоляция.",
     "upright_meaning": "Финансовые потери, нужда, одиночество, испытания.",
     "reversed_meaning": "Выход из кризиса, поддержка, восстановление."},

    {"name": "Шестерка Пентаклей", "arcana": "minor", "suit": "pentacles",
     "description": "Щедрость, помощь, благотворительность.",
     "upright_meaning": "Финансовая поддержка, обмен ресурсами, доброта.",
     "reversed_meaning": "Зависимость от других, неравенство, скрытые мотивы за помощью."},

    {"name": "Семерка Пентаклей", "arcana": "minor", "suit": "pentacles",
     "description": "Терпение, долгосрочные вложения, ожидание результатов.",
     "upright_meaning": "Рост, усилия, вознаграждение за труды.",
     "reversed_meaning": "Разочарование, медленный прогресс, неправильные вложения."},

    {"name": "Восьмерка Пентаклей", "arcana": "minor", "suit": "pentacles",
     "description": "Трудолюбие, обучение, развитие навыков.",
     "upright_meaning": "Усердная работа, самосовершенствование, внимание к деталям.",
     "reversed_meaning": "Лень, отсутствие концентрации, недостаток профессионализма."},

    {"name": "Девятка Пентаклей", "arcana": "minor", "suit": "pentacles",
     "description": "Изобилие, самостоятельность, роскошь.",
     "upright_meaning": "Материальное благополучие, успех, уверенность в себе.",
     "reversed_meaning": "Зависимость, неуверенность, финансовые проблемы."},

    {"name": "Десятка Пентаклей", "arcana": "minor", "suit": "pentacles",
     "description": "Наследие, традиции, семейное богатство.",
     "upright_meaning": "Финансовая стабильность, успех, процветание.",
     "reversed_meaning": "Конфликты в семье, потери, нестабильность."},

    {"name": "Паж Пентаклей", "arcana": "minor", "suit": "pentacles",
     "description": "Новые возможности, обучение, развитие.",
     "upright_meaning": "Любознательность, шанс на успех, усердие.",
     "reversed_meaning": "Отсутствие планов, лень, незрелость."},

    {"name": "Рыцарь Пентаклей", "arcana": "minor", "suit": "pentacles",
     "description": "Стабильность, упорство, надежность.",
     "upright_meaning": "Планомерное движение к цели, трудолюбие, дисциплина.",
     "reversed_meaning": "Лень, рутина, застой, медлительность."},

    {"name": "Королева Пентаклей", "arcana": "minor", "suit": "pentacles",
     "description": "Забота, практичность, изобилие.",
     "upright_meaning": "Материальный комфорт, доброта, забота о близких.",
     "reversed_meaning": "Эгоизм, чрезмерная зависимость от материального, безразличие."},

    {"name": "Король Пентаклей", "arcana": "minor", "suit": "pentacles",
     "description": "Процветание, власть, финансовая мудрость.",
     "upright_meaning": "Стабильность, успех, уверенность в себе, надежность.",
     "reversed_meaning": "Жадность, коррумпированность, материализм, страх потерь."}
]


async def seed_tarot_cards():
    """Заполняет таблицу картами Таро, избегая дублирования."""
    
    all_tarot_cards = tarot_cards + tarot_cards_wands + tarot_cards_cups + tarot_cards_swords + tarot_cards_pentacles

    try:
        async with async_session() as session:

            result = await session.execute(select(TarotCard.name))
            existing_cards = {card for card in result.scalars()}

            new_cards = [
                TarotCard(**card) for card in all_tarot_cards if card["name"] not in existing_cards
            ]

            if new_cards:
                session.add_all(new_cards)
                await session.commit()
                print(f"Добавлено новых карт: {len(new_cards)}")
            else:
                print("Все карты уже есть в базе, изменений не требуется.")
    
    except Exception as e:
        print(f"Ошибка при заполнении БД картами Таро: {e}")

if __name__ == "__main__":
    logging.basicConfig(level=logging.INFO)
    asyncio.run(seed_tarot_cards())






